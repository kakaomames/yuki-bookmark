<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>å¤§å­¦è©¦é¨“å¯¾ç­–å•é¡Œã¨è§£èª¬å‹•ç”»ã®è¡¨ç¤º</title>
    <link rel="icon" href="https://kakaomames.github.io/rei/logo.png">
<!--    <style>
        body { background: #0f0f0f; color: white; font-family: Roboto, Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .yt-container { position: relative; width: 90%; max-width: 1000px; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        video { width: 100%; display: block; }
        
        /* YouTubeé¢¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« */
        .yt-controls { position: absolute; bottom: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.7)); padding: 10px; box-sizing: border-box; opacity: 0; transition: opacity 0.2s; }
        .yt-container:hover .yt-controls { opacity: 1; }
        
        .progress-area { height: 4px; background: rgba(255,255,255,0.2); margin-bottom: 10px; cursor: pointer; position: relative; }
        .progress-bar { height: 100%; background: #f00; width: 0%; }
        
        .bottom-controls { display: flex; align-items: center; justify-content: space-between; }
        .left-controls, .right-controls { display: flex; align-items: center; gap: 15px; }
        
        button { background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 5px; }
        
        /* éŸ³é‡ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ */
        .volume-container { display: flex; align-items: center; gap: 5px; }
        #volume-slider { width: 0; transition: width 0.2s; cursor: pointer; accent-color: #fff; }
        .volume-container:hover #volume-slider { width: 60px; }
        
        .yt-menu { position: absolute; bottom: 50px; right: 10px; background: rgba(28,28,28,0.9); border-radius: 8px; padding: 10px; list-style: none; display: none; }
        .yt-menu.show { display: block; }
        .yt-menu li { padding: 8px 12px; cursor: pointer; font-size: 14px; }
        .yt-menu li:hover { background: rgba(255,255,255,0.1); }
    </style>
</head>
<body>
<h1><a href="./y">æ­£è¦å“ã«æˆ»ã‚‹(ã“ã‚Œã¯è©¦ä½œå“ã§ã™)</a></h1><br><br>
<div class="yt-container">
    <video id="main-video" playsinline></video>
    
    <div class="yt-controls">
        <div class="progress-area" id="progress-area"><div class="progress-bar" id="progress-bar"></div></div>
        
        <div class="bottom-controls">
            <div class="left-controls">
                <button id="play-pause">â–¶</button>
                <div class="volume-container">
                    <button id="mute-btn">ğŸ”Š</button>
                    <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1">
                </div>
                <span id="time-display">0:00 / 0:00</span>
            </div>
            
            <div class="right-controls">
                <button id="settings-btn">âš™ï¸</button>
                <button id="fullscreen-btn">ğŸ”³</button>
            </div>
        </div>
    </div>
    
    <ul id="quality-menu" class="yt-menu"></ul>
</div>

<script>
let audioTrack = new Audio();
const video = document.getElementById('main-video');
const playBtn = document.getElementById('play-pause');
const volSlider = document.getElementById('volume-slider');
const progressArea = document.getElementById('progress-area');
const progressBar = document.getElementById('progress-bar');

async function init(videoId) {
    const res = await fetch(`https://xeroxapp032.vercel.app/api/v1/oisogi/${videoId}`);
    const data = await res.json();
    
    // åˆæœŸã‚»ãƒƒãƒˆ (æœ€é«˜ç”»è³ª & éŸ³å£°)
    video.src = data.streams.video[0].url;
    audioTrack.src = data.streams.audio[0].url;
    
    // ç”»è³ªãƒ¡ãƒ‹ãƒ¥ãƒ¼ä½œæˆ
    const menu = document.getElementById('quality-menu');
    data.streams.video.forEach(v => {
        const li = document.createElement('li');
        li.textContent = `${v.itag}p`;
        li.onclick = () => {
            const time = video.currentTime;
            video.src = v.url;
            video.currentTime = time;
            if(!video.paused) video.play();
            menu.classList.remove('show');
        };
        menu.appendChild(li);
    });
}

// --- åŒæœŸã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ  ---
playBtn.onclick = () => {
    if(video.paused) { video.play(); audioTrack.play(); playBtn.textContent = 'â¸'; }
    else { video.pause(); audioTrack.pause(); playBtn.textContent = 'â–¶'; }
};

// ã€éŸ³é‡èª¿æ•´ã€‘ã“ã“ãŒéšŠå“¡ã®ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆï¼
volSlider.oninput = (e) => {
    const vol = e.target.value;
    video.volume = vol;      // æ˜ åƒï¼ˆä¸€å¿œï¼‰
    audioTrack.volume = vol; // æœ¬å‘½ã®éŸ³
    document.getElementById('mute-btn').textContent = vol == 0 ? 'ğŸ”‡' : 'ğŸ”Š';
};

video.ontimeupdate = () => {
    const p = (video.currentTime / video.duration) * 100;
    progressBar.style.width = p + '%';
};

// ã‚·ãƒ¼ã‚¯ï¼ˆé£›ã°ã—è¦‹ï¼‰åŒæœŸ
progressArea.onclick = (e) => {
    const rect = progressArea.getBoundingClientRect();
    const pos = (e.clientX - rect.left) / rect.width;
    video.currentTime = pos * video.duration;
    audioTrack.currentTime = video.currentTime;
};

document.getElementById('settings-btn').onclick = () => document.getElementById('quality-menu').classList.toggle('show');

// èµ·å‹•ï¼
// --- URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰IDã‚’å–å¾—ã—ã¦èµ·å‹•ã™ã‚‹æŒ‡æ®å®˜ã‚³ãƒ¼ãƒ‰ ---
(function() {
    // 1. ç¾åœ¨ã®URLã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ?v=...ï¼‰ã‚’è§£æ
    const urlParams = new URLSearchParams(window.location.search);
    
    // 2. å¤‰æ•°idsã«è¨­å®šï¼ˆã‚‚ã—ç„¡ã‹ã£ãŸã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆIDã‚’ã‚»ãƒƒãƒˆï¼‰
    const ids = urlParams.get('v') || "b2mX9Aj4wFY"; 
    
    console.log(`ğŸ“¡ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆIDè£œè¶³: ${ids}`);
    
    // 3. æŒ‡ä»¤é–‹å§‹ï¼
    if (typeof init === "function") {
        init(ids);
    } else {
        console.error("âŒ inité–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚é…ç½®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼");
    }
})();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Gemiprocraft - Test Player</title>-->
    <link rel="icon" href="https://kakaomames.github.io/rei/logo.png">
    <style>
        body { background: #0f0f0f; color: white; font-family: Roboto, Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        
        /* --- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã®è£…ç”² --- */
        #loading-screen { text-align: center; }
        .spinner {
            width: 50px; height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #ff0000; /* YouTube Red */
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #loading-msg { font-size: 16px; color: #aaa; }

        /* --- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠï¼ˆæœ€åˆã¯éè¡¨ç¤ºï¼‰ --- */
        #player-wrapper { display: none; width: 90%; max-width: 1000px; text-align: center; }
        .yt-container { position: relative; background: #000; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        video { width: 100%; display: block; cursor: pointer; }
        
        .yt-controls { position: absolute; bottom: 0; width: 100%; background: linear-gradient(transparent, rgba(0,0,0,0.7)); padding: 10px; box-sizing: border-box; opacity: 0; transition: opacity 0.2s; z-index: 10; }
        .yt-container:hover .yt-controls { opacity: 1; }
        
        .progress-area { height: 4px; background: rgba(255,255,255,0.2); margin-bottom: 10px; cursor: pointer; position: relative; }
        .progress-bar { height: 100%; background: #f00; width: 0%; }
        
        .bottom-controls { display: flex; align-items: center; justify-content: space-between; }
        .left-controls, .right-controls { display: flex; align-items: center; gap: 15px; }
        
        button { background: none; border: none; color: white; font-size: 20px; cursor: pointer; padding: 5px; }
        .volume-container { display: flex; align-items: center; gap: 5px; }
        #volume-slider { width: 0; transition: width 0.2s; cursor: pointer; accent-color: #fff; }
        .volume-container:hover #volume-slider { width: 60px; }
        
        .yt-menu { position: absolute; bottom: 50px; right: 10px; background: rgba(28,28,28,0.95); border-radius: 8px; padding: 10px; list-style: none; display: none; z-index: 20; }
        .yt-menu.show { display: block; }
        .yt-menu li { padding: 8px 12px; cursor: pointer; font-size: 14px; text-align: left; }
        .yt-menu li:hover { background: rgba(255,255,255,0.1); }
        
        a.back-link { color: #555; text-decoration: none; font-size: 12px; display: block; margin-top: 10px; }
        a.back-link:hover { color: #888; }
    </style>
</head>
<body>

    <div id="loading-screen">
        <div class="spinner"></div>
        <div id="loading-msg">ğŸ“¡ åŸºåœ°(API)ã¨é€šä¿¡ä¸­...</div>
    </div>

    <div id="player-wrapper">
        <div class="yt-container">
            <video id="main-video" playsinline></video>
            <div class="yt-controls">
                <div class="progress-area" id="progress-area"><div class="progress-bar" id="progress-bar"></div></div>
                <div class="bottom-controls">
                    <div class="left-controls">
                        <button id="play-pause">â–¶</button>
                        <div class="volume-container">
                            <button id="mute-btn">ğŸ”Š</button>
                            <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1">
                        </div>
                        <span id="time-display" style="font-size: 13px;">0:00 / 0:00</span>
                    </div>
                    <div class="right-controls">
                        <button id="settings-btn">âš™ï¸</button>
                        <button id="fullscreen-btn">ğŸ”³</button>
                    </div>
                </div>
            </div>
            <ul id="quality-menu" class="yt-menu"></ul>
        </div>
        <a href="./y" class="back-link">æ­£è¦å“ã«æˆ»ã‚‹(è©¦ä½œå“)</a>
    </div>

<script>
let audioTrack = new Audio();
const video = document.getElementById('main-video');
const playBtn = document.getElementById('play-pause');
const volSlider = document.getElementById('volume-slider');
const progressArea = document.getElementById('progress-area');
const progressBar = document.getElementById('progress-bar');
const timeDisplay = document.getElementById('time-display');

async function init(videoId) {
    const loadingScreen = document.getElementById('loading-screen');
    const playerWrapper = document.getElementById('player-wrapper');
    const msg = document.getElementById('loading-msg');

    try {
        // ãŠæ€¥ãã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹ï¼
        msg.innerText = `ğŸ” å‹•ç”»(${videoId})ã‚’ç´¢æ•µä¸­...`;
        const res = await fetch(`https://xeroxapp032.vercel.app/api/v1/oisogi/${videoId}`);
        const data = await res.json();
        
        if (!data.streams.video.length) throw new Error("æœ‰åŠ¹ãªã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");

        // UIåˆ‡ã‚Šæ›¿ãˆï¼šãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¶ˆã—ã¦ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¡¨ç¤ºï¼
        loadingScreen.style.display = 'none';
        playerWrapper.style.display = 'block';

        // åˆæœŸã‚»ãƒƒãƒˆ (æ˜ åƒ & éŸ³å£°)
        video.src = data.streams.video[0].url;
        audioTrack.src = data.streams.audio[0] ? data.streams.audio[0].url : "";
        
        // ç”»è³ªãƒ¡ãƒ‹ãƒ¥ãƒ¼ä½œæˆ
        const menu = document.getElementById('quality-menu');
        data.streams.video.forEach(v => {
            const li = document.createElement('li');
            li.textContent = `${v.itag}p`;
            li.onclick = () => {
                const time = video.currentTime;
                video.src = v.url;
                video.currentTime = time;
                if(!video.paused) video.play();
                menu.classList.remove('show');
            };
            menu.appendChild(li);
        });

        setupSyncControls();
        console.log("ğŸš€ ã‚·ã‚¹ãƒ†ãƒ ã‚ªãƒ¼ãƒ«ã‚°ãƒªãƒ¼ãƒ³ï¼å†’é™ºé–‹å§‹ï¼");

    } catch (e) {
        msg.innerHTML = `<span style="color:#ff4444;">ğŸ’¥ ã‚¨ãƒ©ãƒ¼: ${e.message}</span>`;
        console.error(e);
    }
}

function setupSyncControls() {
    playBtn.onclick = () => {
        if(video.paused) { video.play(); audioTrack.play(); playBtn.textContent = 'â¸'; }
        else { video.pause(); audioTrack.pause(); playBtn.textContent = 'â–¶'; }
    };

    volSlider.oninput = (e) => {
        const vol = e.target.value;
        video.volume = vol;
        audioTrack.volume = vol;
        document.getElementById('mute-btn').textContent = vol == 0 ? 'ğŸ”‡' : 'ğŸ”Š';
    };

    video.ontimeupdate = () => {
        const p = (video.currentTime / video.duration) * 100;
        progressBar.style.width = p + '%';
        
        const cur = formatTime(video.currentTime);
        const dur = formatTime(video.duration || 0);
        timeDisplay.textContent = `${cur} / ${dur}`;
    };

    progressArea.onclick = (e) => {
        const rect = progressArea.getBoundingClientRect();
        const pos = (e.clientX - rect.left) / rect.width;
        video.currentTime = pos * video.duration;
        audioTrack.currentTime = video.currentTime;
    };

    document.getElementById('settings-btn').onclick = () => document.getElementById('quality-menu').classList.toggle('show');
    document.getElementById('fullscreen-btn').onclick = () => video.requestFullscreen();
}

function formatTime(sec) {
    const m = Math.floor(sec / 60);
    const s = Math.floor(sec % 60);
    return `${m}:${s < 10 ? '0' : ''}${s}`;
}

// èµ·å‹•ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
(function() {
    const urlParams = new URLSearchParams(window.location.search);
    const ids = urlParams.get('v') || "b2mX9Aj4wFY";
    init(ids);
})();
</script>
</body>
</html>
